<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Farm Robot Control</title>
<link rel="stylesheet" href="/style.css">
</head>
<body>

<div id="app">

  <!-- ‚îÄ‚îÄ ÂÖ®Â±èÊëáÊùÜÔºàÂ∫ïÂ±Ç z-index:0Ôºâ‚îÄ‚îÄ -->
  <div id="joystick-zone">
    <span id="joystick-hint">TOUCH TO CONTROL</span>
    <!-- AUTO MODE overlay -->
    <div id="auto-overlay">
      <div id="auto-overlay-text">AUTO MODE</div>
      <div id="auto-overlay-sub">JOYSTICK DISABLED</div>
    </div>
  </div>

  <!-- Ë≠¶ÂëäÊ®™ÂπÖÔºàÈ°∂ÈÉ®Ê†è‰∏ãÊñπÔºåz-index:20Ôºâ-->
  <div id="warn-banner">‚ö† CONNECTION LOST ‚Äî ROBOT STOPPED</div>

  <!-- ‚îÄ‚îÄ È°∂ÈÉ®Ê†è ‚îÄ‚îÄ -->
  <div id="top-bar">
    <span class="title">FARMBOT</span>
    <span id="status-dot"></span>
    <span id="status-text">OFFLINE</span>
    <button id="state-btn" class="state-ready" disabled>
      <span id="state-indicator">‚óè</span>
      <span id="state-label">ACTIVATE</span>
    </button>
    <button id="rec-btn" class="rec-idle">‚óè REC</button>
    <span id="rec-filename">‚Äî</span>
  </div>

  <!-- ‚îÄ‚îÄ Â∑¶‰∏ä HUDÔºöIMU + ÁΩóÁõò ‚îÄ‚îÄ -->
  <div id="hud-left">
    <div class="hud-panel-title">ACCEL</div>
    <div class="hud-value"><span class="hud-label">X</span><span class="hud-num" id="acc-x">--</span></div>
    <div class="hud-value"><span class="hud-label">Y</span><span class="hud-num" id="acc-y">--</span></div>
    <div class="hud-value"><span class="hud-label">Z</span><span class="hud-num" id="acc-z">--</span></div>
    <div class="hud-panel-title" style="margin-top:5px;">GYRO</div>
    <div class="hud-value"><span class="hud-label">X</span><span class="hud-num" id="gyro-x">--</span></div>
    <div class="hud-value"><span class="hud-label">Y</span><span class="hud-num" id="gyro-y">--</span></div>
    <div class="hud-value"><span class="hud-label">Z</span><span class="hud-num" id="gyro-z">--</span></div>
    <div class="hud-panel-title" style="margin-top:5px;">COMPASS</div>
    <div id="compass-svg-wrap">
      <svg id="compass-svg" viewBox="0 0 100 100">
        <!-- Outer ring -->
        <circle cx="50" cy="50" r="46" fill="none" stroke="#1e2d3d" stroke-width="2"/>
        <!-- Cardinal ticks -->
        <g stroke="#5a7080" stroke-width="1.5">
          <line x1="50" y1="6"  x2="50" y2="14"/>
          <line x1="94" y1="50" x2="86" y2="50"/>
          <line x1="50" y1="94" x2="50" y2="86"/>
          <line x1="6"  y1="50" x2="14" y2="50"/>
        </g>
        <!-- Cardinal labels -->
        <text x="50" y="22" text-anchor="middle" fill="#00d4ff" font-size="10" font-family="Courier New">N</text>
        <text x="50" y="84" text-anchor="middle" fill="#5a7080" font-size="9"  font-family="Courier New">S</text>
        <text x="82" y="54" text-anchor="middle" fill="#5a7080" font-size="9"  font-family="Courier New">E</text>
        <text x="18" y="54" text-anchor="middle" fill="#5a7080" font-size="9"  font-family="Courier New">W</text>
        <!-- Needle group (rotated by JS) -->
        <g id="compass-needle" transform="rotate(0,50,50)">
          <polygon points="50,16 46,50 54,50" fill="#ff4060"/>
          <polygon points="50,84 46,50 54,50" fill="#1e2d3d"/>
        </g>
        <!-- Center dot -->
        <circle cx="50" cy="50" r="3" fill="#00d4ff"/>
      </svg>
      <div id="compass-bearing">---¬∞</div>
      <div id="compass-cardinal">--</div>
      <div id="compass-accuracy" class="acc-0">‚óè UNCAL</div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ Âè≥‰∏ä HUDÔºöRTK GPS ‚îÄ‚îÄ -->
  <div id="hud-right">
    <div id="rtk-header">
      <span id="rtk-title">RTK GPS</span>
      <span id="rtk-fix-badge">NO FIX</span>
      <span id="rtk-live-dot" title="RTK OFFLINE"></span>
    </div>
    <div class="rtk-cell">
      <span class="rtk-cell-label">LAT</span>
      <span class="rtk-cell-val accent" id="rtk-lat">--</span>
    </div>
    <div class="rtk-cell">
      <span class="rtk-cell-label">LON</span>
      <span class="rtk-cell-val accent" id="rtk-lon">--</span>
    </div>
    <div class="rtk-cell">
      <span class="rtk-cell-label">ALT (m)</span>
      <span class="rtk-cell-val" id="rtk-alt">--</span>
    </div>
    <div id="rtk-sats-row">
      <div class="rtk-cell">
        <span class="rtk-cell-label">SATS</span>
        <span class="rtk-cell-val" id="rtk-sats">--</span>
      </div>
      <div class="rtk-cell">
        <span class="rtk-cell-label">HDOP</span>
        <span class="rtk-cell-val" id="rtk-hdop">--</span>
      </div>
      <div class="rtk-cell">
        <span class="rtk-cell-label">SPD(kn)</span>
        <span class="rtk-cell-val" id="rtk-spd">--</span>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ ÂØºËà™Áä∂ÊÄÅÈù¢ÊùøÔºàÂ±Ö‰∏≠È°∂ÈÉ®Ôºå‰ªÖÂØºËà™Êó∂ÊòæÁ§∫Ôºâ‚îÄ‚îÄ -->
  <div id="nav-status-panel">
    <div id="nav-status-grid">
      <div class="nav-cell">
        <span class="nav-cell-label">PROGRESS</span>
        <span class="nav-cell-val green" id="nav-progress">‚Äî</span>
      </div>
      <div class="nav-cell">
        <span class="nav-cell-label">DIST (m)</span>
        <span class="nav-cell-val" id="nav-dist">‚Äî</span>
      </div>
      <div class="nav-cell">
        <span class="nav-cell-label">BEAR (¬∞)</span>
        <span class="nav-cell-val" id="nav-bearing">‚Äî</span>
      </div>
      <div class="nav-cell">
        <span class="nav-cell-label">MODE</span>
        <span class="nav-cell-val" id="nav-mode-disp">‚Äî</span>
      </div>
      <div class="nav-cell">
        <span class="nav-cell-label">FILTER</span>
        <span class="nav-cell-val" id="nav-filter-disp">‚Äî</span>
      </div>
      <div class="nav-cell">
        <span class="nav-cell-label">TOL (m)</span>
        <span class="nav-cell-val" id="nav-tol">‚Äî</span>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ Bottom Control Bar: Speed + Navigation ‚îÄ‚îÄ -->
  <div id="bottom-bar">
    <span id="speed-label">SPD</span>
    <input type="range" id="speed-slider" min="10" max="100" step="10" value="50">
    <span id="speed-value">50%</span>
    <input type="file" id="csv-file-input" accept=".csv,text/csv">
    <button id="nav-upload-btn">üìÇ CSV</button>
    <span id="nav-wp-count">0 WP</span>
    <button class="nav-mode-btn active" id="btn-p2p"     title="Point To Point Direct Navigation">P2P</button>
    <button class="nav-mode-btn"        id="btn-pursuit" title="Pure Pursuit Path Tracking">PURSUIT</button>
    <button class="nav-mode-btn active" id="btn-mavg"    title="Moving Average GPS Smoothing">M-AVG</button>
    <button class="nav-mode-btn"        id="btn-kalman"  title="Kalman Filter GPS+IMU Fusion">KALMAN</button>
    <button id="nav-auto-btn" class="nav-idle">‚ñ∂ AUTO</button>
  </div>

  <!-- Hidden Joy Data Element Used By JS Update Joy UI Not Displayed In The Interface-->
  <div id="joy-data-hidden">
    <span id="joy-force"></span>
    <span id="joy-linear"></span>
    <span id="joy-angular"></span>
    <span id="joy-dir"></span>
  </div>

</div>

<script src="/nipplejs.min.js"></script>
<script src="/app.js"></script>
</body>
</html>
